# KV-stores(memcached, redis, levelDB ...)

KV存储的基本接口是put, get和remove，很多KV存储支持scans操作（两个输入：upper bound和lower bound）。



## levelDB 和 

#### LSM存储

levelDB是一个KV存储，基于LSMT(Log-Structured Merge Tree)结构。

LSM主要优化磁盘写，分两层(tier)，内存层(memory component)和磁盘层(disk component)，内存层主要用来作cache和buffer，put和delete这两种update操作在这里进行并迅速返回。磁盘层有分为很多层(level)，每个level中有1个或多个文件，如果要求严格，改内存层之前，可以先将所有更改写到磁盘的commit-log中。

LSM的关键操作是compaction，一个后台的操作，一个或者多个专用的线程进行，内存中的memory component达到一定的阈值，会被merge到disk中。compaction分两步：1）把暂时不可更改的memory component写到disk；2）重新组织磁盘上的结构，将文件移动、merge到合适的levels。

在内存层中，可以用顺序的skiplist或者乱序的hash table，顺序skiplist需要在插入操作时用log时间进行排序，但是scan操作和compaction操作会比较快。用乱序hash table，插入是常数时间，但是scan会很慢，在compaction时会进行全部的重排序再写磁盘，所以时间比较长。

#### skip list


---

[1] O. Balmau, R. Guerraoui, V. Trigonakis, and I. Zablotchi, “FloDB : Unlocking Memory in Persistent Key-Value Stores,” EuroSys ’17, 2017.
